---
layout: post
title: 玩玩微服务（持更）
category: 技术
keywords: golang,k8s,docker,微服务,后端
comments: false
---

## 忍不住
一直看人家面试要求 K8s + docker，然而这个经验对于一般的公司来说是十分宝贵的。
（能有大场景的公司能有几个啊？捂脸）
但是好奇心还是趋势我去实现一个最最最最简单的 k8s + docker 提供服务的场景。
所以这篇文章就要从 0 开始搭建这么一套服务。

## 准备
- docker
- k8s
- golang
- grpc

### 预备概念：
大家有时候会把 docker 看做是虚拟机，这个没有问题，但是我想说的是：一个“容器”，实际上是一个由 Linux Namespace、Linux Cgroups 和 rootfs 三种技术构建出来的进程的隔离环境。严格意义上，docker 并不等同于 VM。

在安装 kubernetes 的时候，请使用阿里云的镜像安装。什么？你有 VPN？
没用的朋友，安装过程中会在 容器中再行进行镜像的拉取，除非你修改安装脚本 设置 http proxy，否则还是会被墙的。

grpc 一般结合 protobuf 更加美味哦。当然 grpc 还是建立在 http 基础上的通讯框架。

### 关于 kubernetes 
说实话，关于 k8s 的概念完全可以另开一篇文章了。
但是我尽可能用最少的语言白话一下关键的概念点。

首先你要明白，k8s 最终操作的是 docker。为了让好多好多 docker 管理起来更加方便，也易于伸缩。
把 k8s 想象成一个大箱子，里面会有分割成不同大小的篮子，有哪几种篮子，颗粒度分别是怎样的呢？

#### Pod

#### Deployment

#### Service


## 开始

一个简单的场景：
我们有一个机子，在不停发送信息，这个信息发送量和时间没有任何规律可言，有时候一秒钟1条。
有时候1秒上万条。
而我们要做的是把这些消息接受，放入 redis 中的队列，然后处理并输出。（非常通用的场景）
所以我们的架构可能是这样的：
![]()
